var $=window.jQuery;api=wp.customize||{},window.BxExtensions={v:{panel:"businessx_panel__sections",admin:bxext_widgets_customizer.admin_url,icons:bxext_widgets_customizer.icons,sections:bxext_widgets_customizer.sections,sections_position:bxext_widgets_customizer.sections_position,msgs:bxext_widgets_customizer.msgs,actions:$("#customize-header-actions")},init:function(){var a=this;a.initFirstViewModal(),a.initSortableSections(),a.backup()},initSortableSections:function(){var a=this,b=$(a.panelSections());b.sortable({helper:"clone",items:"> li.control-section:not(.cannot-expand)",cancel:"li.ui-sortable-handle.open",delay:150,axis:"y",create:function(b,c){var d=a.sectionsArray(),e=d,f=a.v.sections_position,g=e.length==f.length&&e.every(function(a,b){return a===f[b]});g||a.setSectionsPosition(d)},update:function(c,d){b.find(".bx_drag_and_spinner").show(),a.setSectionsPosition(a.sectionsArray()),$(".wp-full-overlay-sidebar-content").scrollTop(0)}})},panelHandle:function(){return api.panel(this.v.panel).container.get(0)},panelSections:function(){return api.panel(this.v.panel).contentContainer},sectionsArray:function(){var a=this,b=a.panelSections();items=$(b).sortable("toArray");for(var c=0;c<items.length;c++)items[c]=items[c].replace("accordion-section-","");return items},ifAjaxIsDone:function(){var a=this,b=$(a.panelSections());$.each(a.sectionsArray(),function(a,b){api.section(b).priority(a)}),b.find(".bx_drag_and_spinner").hide(),api.previewer.refresh()},setSectionsPosition:function(a){var b=this;$.ajax({url:ajaxurl,type:"post",dataType:"json",data:{action:"businessx_extensions_sections_position",n_sections:bxext_customizer_nonces.n_sections,items:a}}).done(function(a){b.ifAjaxIsDone()})},backup:function(){var a=this,b=a.v.actions,c=a.v.msgs,d=$(document),e=b.find(".save");b.prepend('<a href="#" class="customize-controls-close bx-backup-sections"><span class="bx-backup-pulse"></span><span class="bx-backup-bubble">'+c.bk_bubble+"</span></a>"),d.on("click",".bx-backup-sections",function(a){a.preventDefault(),e.is(":disabled")===!0?$.ajax({url:ajaxurl,type:"post",dataType:"json",data:{action:"businessx_extensions_sections_bk",n_sections_bk:bxext_customizer_nonces.n_sections_bk}}).done(function(a){$(".bx-backup-pulse").hide(),alert(c.bk_success),d.trigger("bx-backup-success")}):alert(c.bk_fail)}),d.on("widget-added widget-updated",function(a){$(".bx-backup-pulse").show()}),d.on("click",".bx-restore-sections",function(a){a.preventDefault(),e.is(":disabled")===!0?$.ajax({url:ajaxurl,type:"post",dataType:"json",data:{action:"businessx_extensions_sections_rt",n_sections_rt:bxext_customizer_nonces.n_sections_rt}}).done(function(a){alert(c.bk_restore_success),location.reload(!0)}):alert(c.bk_fail)})},initFirstViewModal:function(){$("#businessx-frontpage-modal").length>0&&(window.tb_show(bxext_frontpage_vars.modal_title,"#TB_inline?width=570&height=330&inlineId=businessx-frontpage-modal"),$("#TB_window").css("z-index","500002").addClass("bxext-stp-modal-window"),$("#TB_overlay").css("z-index","500001").addClass("bxext-stp-modal-overlay"),$("#TB_overlay.bxext-stp-modal-overlay").off("click")),$("#bxext-insert-frontpage").on("click",function(a){$.ajax({url:ajaxurl,type:"post",dataType:"json",data:{action:"bxext_create_frontpage",bxext_create_frontpage:bxext_customizer_nonces.bxext_create_frontpage}}).done(function(a){window.tb_remove(),location.reload(!0)})}),$("#bxext-dismiss-frontpage").on("click",function(a){$.ajax({url:ajaxurl,type:"post",dataType:"json",data:{action:"bxext_dismiss_create_frontpage",bxext_create_frontpage:bxext_customizer_nonces.bxext_dismiss_create_frontpage}}).done(function(a){window.tb_remove(),location.reload(!0)})})}},$(document).ready(function(a){var b=window.BxExtensions;b.init()});
